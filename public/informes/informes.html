<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CSF | Informes</title>

  <link rel="icon" type="image/png" href="/src/csf-logo.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="../dashboard/dashboard.css" />
  <link rel="stylesheet" href="./informes.css" />
</head>

<body>
  <div class="bg">
    <span class="bg-blob b1"></span>
    <span class="bg-blob b2"></span>
    <span class="bg-grid"></span>
  </div>

  <header class="topbar" role="navigation" aria-label="Barra principal">
    <a class="brand" href="/dashboard" aria-label="Inicio">
      <img class="brand-logo" src="/src/csf-logo3.png" alt="CSF" />
      <div class="brand-copy">
        <span>Monitoreo de Máquinas - Informes</span>
      </div>
    </a>

    <div class="actions">
      <button id="menuBtn" class="menu-btn" aria-haspopup="menu" aria-expanded="false" aria-controls="userMenu" title="Menú">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="5" cy="12" r="2" />
          <circle cx="12" cy="12" r="2" />
          <circle cx="19" cy="12" r="2" />
        </svg>
      </button>

      <div id="userMenu" class="menu" role="menu" aria-labelledby="menuBtn">
        <a role="menuitem" class="menu-item" href="/dashboard/dashboard.html">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" /></svg>
          Dashboard
        </a>
        <a role="menuitem" class="menu-item" href="/historicos/historicos.html">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M5 4h14v2H5zM5 18h14v2H5zM5 9h14v6H5z" /></svg>
          Históricos
        </a>
        <a role="menuitem" class="menu-item" href="/informes/informes.html">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19 3H5a2 2 0 00-2 2v14l4-4h12a2 2 0 002-2V5a2 2 0 00-2-2z" /></svg>
          Informes
        </a>
        <button role="menuitem" class="menu-item danger" id="logoutBtn">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M10 17l1.41-1.41L8.83 13H21v-2H8.83l2.58-2.59L10 7l-5 5 5 5zM4 19h6v2H4a2 2 0 01-2-2V5a2 2 0 012-2h6v2H4v14z" />
          </svg>
          Cerrar sesión
        </button>
      </div>
    </div>
  </header>

  <div id="toast" class="toast" hidden>
    <span class="msg"></span>
    <button class="close" aria-label="Cerrar">
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
        <path fill="currentColor" d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.3 19.71 2.89 18.3 9.17 12 2.89 5.71 4.3 4.29 10.59 10.6 16.89 4.29z" />
      </svg>
    </button>
  </div>

  <main class="page">
    <section class="card metrics">
      <div class="metric">
        <div class="metric-label">Informes totales</div>
        <div class="metric-value" id="mTotal">—</div>
      </div>
      <div class="metric">
        <div class="metric-label">Generados hoy</div>
        <div class="metric-value" id="mToday">—</div>
      </div>
    </section>

    <section class="card">
      <h1>Lista de informes</h1>

      <div class="filters">
        <!-- (existente) -->
        <div class="control">
          <label for="quickDay">Filtrar por día</label>
          <select id="quickDay">
            <option value="all">Todos</option>
            <option value="today">Hoy</option>
            <option value="yesterday">Ayer</option>
            <option value="7">Últimos 7 días</option>
            <option value="30">Últimos 30 días</option>
          </select>
        </div>

        <!-- (existente) -->
        <div class="control">
          <label for="dateExact">Buscar por fecha exacta</label>
          <input id="dateExact" type="date" />
        </div>

        <!-- (NUEVO) Tipo de informe -->
        <div class="control">
          <label for="typeFilter">Tipo de informe</label>
          <select id="typeFilter">
            <option value="">Todos</option>
            <option value="general">General</option>
            <option value="individual">Individual (por máquina)</option>
          </select>
        </div>

        <!-- (NUEVO) Buscar por máquina / texto -->
        <div class="control">
          <label for="qMachine">Buscar por máquina o texto</label>
          <input id="qMachine" type="text" placeholder="Ej: MF-123, Máquina 7, cliente, etc." />
        </div>

        <!-- (existente) -->
        <div class="control align-end">
          <button id="btnClear" class="btn ghost">Limpiar</button>
        </div>
      </div>
    </section>

    <section class="card slim">
      <h2 class="section-title">Informes</h2>
      <div class="table-wrap">
        <!-- CABECERA: 3 columnas (no se toca) -->
        <table class="data-table head-only" aria-hidden="true">
          <colgroup>
            <col class="col-name" />
            <col class="col-date" />
            <col class="col-action" />
          </colgroup>
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Fecha</th>
              <th>Acción</th>
            </tr>
          </thead>
        </table>

        <!-- CUERPO: 3 columnas (no se toca) -->
        <div class="table-viewport" role="region" aria-label="Informes (scroll)">
          <table class="data-table body-only">
            <colgroup>
              <col class="col-name" />
              <col class="col-date" />
              <col class="col-action" />
            </colgroup>
            <tbody id="reportsTbody">
              <tr class="loading-row">
                <td colspan="3">
                  <div class="loader"><span class="ring"></span> Cargando informes...</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div id="emptyState" class="empty hidden">
          No hay informes para los filtros seleccionados.
        </div>
      </div>
    </section>
  </main>

  <script src="./informes.js"></script>
</body>
</html>
